{% extends "base.html" %}

{% block title %}FIRICA - {{ quiz.title }}{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-12 mb-4">
            <div class="card shadow">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">{{ quiz.title }}</h4>
                    <small class="d-block mt-2">Total preguntas: {{ quiz.question_count }}</small>
                </div>
                <div class="card-body">
                    <form id="quizForm" method="POST" action="{{ url_for('submit_quiz', quiz_id=quiz.id) }}">
                        {% for q_num in range(1, quiz.question_count+1) %}
                        <div class="card mb-3">
                            <div class="card-header bg-light">
                                Pregunta {{ q_num }}
                            </div>
                            <div class="card-body p-3">
                                <div class="options-vertical">
                                    {% for option in ['A', 'B', 'C', 'D'] %}
                                    <div class="option-item mb-2">
                                        <input type="radio" 
                                               name="answer_{{ q_num }}" 
                                               id="q{{ q_num }}_{{ option }}" 
                                               value="{{ option }}" 
                                               class="btn-check" 
                                               required>
                                        <label for="q{{ q_num }}_{{ option }}" 
                                               class="btn btn-outline-primary w-100 text-start">
                                            <span class="option-letter">{{ option }}.</span>
                                            <span class="option-content">Respuesta {{ option }}</span>
                                        </label>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        
                        <div class="text-center mt-4">
                            <button type="submit" id="submitBtn" class="btn btn-primary btn-lg" disabled>
                                <i class="fas fa-paper-plane me-2"></i>Entregar respuestas
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('quizForm');
    const submitBtn = document.getElementById('submitBtn');
    const totalQuestions = {{ quiz.question_count }};

    function checkCompletion() {
        const answered = document.querySelectorAll('input[type="radio"]:checked').length;
        submitBtn.disabled = answered < totalQuestions;
    }

    form.addEventListener('change', checkCompletion);
});
</script>

<style>
.options-vertical .option-item {
    width: 100%;
}

.option-item .btn {
    padding: 1rem;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
}

.option-letter {
    font-weight: bold;
    width: 2rem;
}

.option-content {
    flex-grow: 1;
}

.option-item input:checked + .btn {
    background-color: var(--primary-color);
    border-color: var(--primary-color);
    color: white;
}
</style>
{% endblock %}